<template>
  <div>
    <NavbarEmployer />

    <div class="container py-6">
      <div class="card mx-auto" style="max-width: 920px">
        <h4 class="title">üìù ‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</h4>

        <form @submit.prevent="submitJob" class="grid gap-5">
          <!-- ‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô / ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà -->
          <div class="form-group grid grid-2 gap-4">
            <div>
              <label class="label">‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô <span class="req">*</span></label>
              <input v-model.trim="job.title" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÇ‡∏õ‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°" required />
            </div>

            <div>
              <label class="label">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà <span class="req">*</span></label>
              <select v-model="job.category" class="select" required>
                <option disabled value="">‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‚Äî</option>
                <option value="‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•">‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•</option>
                <option value="‡∏á‡∏≤‡∏ô‡πÅ‡∏õ‡∏• / ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°">‡∏á‡∏≤‡∏ô‡πÅ‡∏õ‡∏• / ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°</option>
                <option value="‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏î‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ / ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå">‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏î‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ / ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå</option>
                <option value="‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö UX/UI">‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö UX/UI</option>
                <option value="‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å / ‡∏°‡∏±‡∏•‡∏ï‡∏¥‡∏°‡∏µ‡πÄ‡∏î‡∏µ‡∏¢">‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å / ‡∏°‡∏±‡∏•‡∏ï‡∏¥‡∏°‡∏µ‡πÄ‡∏î‡∏µ‡∏¢</option>
                <option value="‡∏Ñ‡∏µ‡∏¢‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• / ‡∏õ‡πâ‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">‡∏Ñ‡∏µ‡∏¢‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• / ‡∏õ‡πâ‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</option>
                <option value="‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢">‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢</option>
                <option value="‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå">‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå</option>
                <option value="‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô">‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô</option>
                <option value="‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏û‡∏à / ‡πÇ‡∏ã‡πÄ‡∏ä‡∏µ‡∏¢‡∏•‡∏°‡∏µ‡πÄ‡∏î‡∏µ‡∏¢">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏û‡∏à / ‡πÇ‡∏ã‡πÄ‡∏ä‡∏µ‡∏¢‡∏•‡∏°‡∏µ‡πÄ‡∏î‡∏µ‡∏¢</option>
                <option value="‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ">‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ</option>
                <option value="‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏á‡∏≤‡∏ô‡πÑ‡∏≠‡∏ó‡∏µ">‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏á‡∏≤‡∏ô‡πÑ‡∏≠‡∏ó‡∏µ (IT Support)</option>
                <option value="‡∏≠‡∏∑‡πà‡∏ô ‡πÜ">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
              </select>
            </div>
          </div>

          <!-- ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î / ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥ -->
          <div class="grid grid-2 gap-4">
            <div>
              <label class="label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô</label>
              <textarea v-model.trim="job.description" class="input" rows="4"
                        placeholder="‡∏™‡∏£‡∏∏‡∏õ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏° (bullet ‡πÑ‡∏î‡πâ)"></textarea>
            </div>
            <div>
              <label class="label">‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£</label>
              <textarea v-model.trim="job.qualification" class="input" rows="4"
                        placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏µ‡πÇ‡∏ô‡πâ‡∏ï‡∏ö‡∏∏‡πä‡∏Å, ‡πÉ‡∏ä‡πâ Photoshop ‡πÑ‡∏î‡πâ, ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡∏°"></textarea>
            </div>
          </div>

          <!-- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö -->
          <div class="grid grid-2 gap-4">
            <div>
              <label class="label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö</label>
              <input v-model.trim="job.vacancy" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2 ‡∏≠‡∏±‡∏ï‡∏£‡∏≤" />
            </div>
          </div>

          <!-- ‡∏ä‡∏ô‡∏¥‡∏î‡∏á‡∏≤‡∏ô -->
          <div>
            <label class="label">‡∏ä‡∏ô‡∏¥‡∏î‡∏á‡∏≤‡∏ô</label>
            <div class="chips">
              <button type="button" class="chip" :class="{active: ui.kind==='‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß'}"
                      @click="setKind('‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß','‡πÄ‡∏´‡∏°‡∏≤‡∏á‡∏≤‡∏ô')">‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</button>
              <button type="button" class="chip" :class="{active: ui.kind==='‡∏£‡∏≤‡∏¢‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á'}"
                      @click="setKind('‡∏£‡∏≤‡∏¢‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á','‡∏£‡∏≤‡∏¢‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á')">‡∏£‡∏≤‡∏¢‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</button>
              <button type="button" class="chip" :class="{active: ui.kind==='‡∏û‡∏≤‡∏£‡πå‡∏ó‡πÑ‡∏ó‡∏°‡πå(‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô)'}"
                      @click="setKind('‡∏û‡∏≤‡∏£‡πå‡∏ó‡πÑ‡∏ó‡∏°‡πå(‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô)','‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô')">‡∏û‡∏≤‡∏£‡πå‡∏ó‡πÑ‡∏ó‡∏°‡πå (‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô)</button>
              <button type="button" class="chip" :class="{active: ui.kind==='‡∏ü‡∏π‡∏•‡πÑ‡∏ó‡∏°‡πå(‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)'}"
                      @click="setKind('‡∏ü‡∏π‡∏•‡πÑ‡∏ó‡∏°‡πå(‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)','‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô')">‡∏ü‡∏π‡∏•‡πÑ‡∏ó‡∏°‡πå (‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</button>
            </div>
          </div>

          <!-- ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏á‡∏≤‡∏ô -->
          <div>
            <label class="label">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏á‡∏≤‡∏ô</label>
            <template v-if="ui.kind==='‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß'">
              <div class="pill-fixed">‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</div>
              <div class="mt-2">
                <label class="label sub">‡∏ß‡∏±‡∏ô‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                <input type="date" v-model="ui.dueDate" class="input"/>
              </div>
            </template>
            <template v-else>
              <div class="chips">
                <button type="button" class="chip" :class="{active: ui.durationPreset==='‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á'}"
                        @click="ui.durationPreset='‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á'">‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á</button>
                <button type="button" class="chip" :class="{active: ui.durationPreset==='1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'}"
                        @click="ui.durationPreset='1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'">1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</button>
                <button type="button" class="chip" :class="{active: ui.durationPreset==='3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'}"
                        @click="ui.durationPreset='3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'">3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</button>
                <button type="button" class="chip" :class="{active: ui.durationPreset==='6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'}"
                        @click="ui.durationPreset='6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'">6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</button>
              </div>
            </template>
          </div>

          <!-- ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á -->
          <div>
            <label class="label">‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á</label>
            <div class="grid grid-2 gap-4">
              <div>
                <select v-model="job.salary_type" class="select">
                  <option disabled value="">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á</option>
                  <option value="‡∏£‡∏≤‡∏¢‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á">‡∏£‡∏≤‡∏¢‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</option>
                  <option value="‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô">‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</option>
                  <option value="‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô">‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
                  <option value="‡πÄ‡∏´‡∏°‡∏≤‡∏á‡∏≤‡∏ô">‡πÄ‡∏´‡∏°‡∏≤‡∏á‡∏≤‡∏ô</option>
                  <option value="‡∏ï‡∏≤‡∏°‡∏ï‡∏Å‡∏•‡∏á">‡∏ï‡∏≤‡∏°‡∏ï‡∏Å‡∏•‡∏á</option>
                </select>
              </div>
              <div v-if="job.salary_type !== '‡∏ï‡∏≤‡∏°‡∏ï‡∏Å‡∏•‡∏á'">
                <select v-model.number="job.salary_value" class="select">
                  <option disabled :value="null">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤</option>
                  <option v-for="v in salaryAmountOptions" :key="v" :value="v">
                    {{ v.toLocaleString() }} ‡∏ö‡∏≤‡∏ó
                  </option>
                </select>
              </div>
            </div>
            <div class="hint" v-if="job.salary_type==='‡πÄ‡∏´‡∏°‡∏≤‡∏á‡∏≤‡∏ô'">* ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πà‡∏≠‡∏ä‡∏¥‡πâ‡∏ô‡∏á‡∏≤‡∏ô</div>
          </div>

          <!-- ‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô -->
          <div>
            <label class="label">‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label>

            <div v-if="ui.kind==='‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß'" class="pill-muted">‡∏ï‡∏≤‡∏°‡∏ï‡∏Å‡∏•‡∏á/‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô</div>

            <template v-else>
              <div class="chips mb-2">
                <button type="button" class="chip" @click="selectWeekdays">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡∏à.-‡∏®.</button>
                <button type="button" class="chip" @click="selectEveryday">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</button>
                <button type="button" class="chip" @click="toggleAllDays">‡∏™‡∏•‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</button>
              </div>

              <div class="days">
                <button v-for="d in days" :key="d.key" type="button"
                        class="day" :class="{active: ui.daysSelected.includes(d.key)}"
                        @click="toggleDay(d.key)">{{ d.label }}</button>
              </div>

              <div class="grid grid-2 gap-4 mt-2">
                <div>
                  <label class="label sub">‡πÄ‡∏£‡∏¥‡πà‡∏° (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
                  <input
                    type="time" lang="th" step="60"
                    v-model="ui.startTime"
                    class="input"
                    placeholder="‡πÄ‡∏ä‡πà‡∏ô 09:00"
                  />
                </div>
                <div>
                  <label class="label sub">‡πÄ‡∏•‡∏¥‡∏Å (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
                  <input
                    type="time" lang="th" step="60"
                    v-model="ui.endTime"
                    class="input"
                    placeholder="‡πÄ‡∏ä‡πà‡∏ô 18:00"
                  />
                </div>
              </div>
            </template>
          </div>

          <!-- ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏û‡∏™‡∏ï‡πå -->
          <div class="summary">
            <div class="sum-item">
              <div class="sum-title">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ </div>
              <div class="sum-val">{{ jDurationString || '‚Äî' }}</div>
            </div>
            <div class="sum-item">
              <div class="sum-title">‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô </div>
              <div class="sum-val">{{ jWorktimeString || '‚Äî' }}</div>
            </div>
            <div class="sum-item">
              <div class="sum-title">‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á </div>
              <div class="sum-val">{{ jSalaryString || '‚Äî' }}</div>
            </div>
          </div>

          <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏û‡∏™‡∏ï‡πå -->
          <button class="btn-primary" type="submit">üìÆ ‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏á‡∏≤‡∏ô</button>
        </form>
      </div>
    </div>
  </div>
</template>

<script>
import NavbarEmployer from "@/components/NavbarEmployer.vue";

export default {
  name: "PostJobBetter",
  components: { NavbarEmployer },
  data() {
    return {
      user: null,
      job: {
        title: "",
        category: "",
        description: "",
        qualification: "",
        vacancy: "",
        salary_type: "",
        salary_value: null,
      },
      ui: {
        kind: "‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß",         // ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        durationPreset: "‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á",
        dueDate: "",
        daysSelected: ["‡∏à", "‡∏≠", "‡∏û", "‡∏û‡∏§", "‡∏®"],
        startTime: "",                 // ‡∏ß‡πà‡∏≤‡∏á = ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö
        endTime: "",                   // ‡∏ß‡πà‡∏≤‡∏á = ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö
      },
      days: [
        { key: "‡∏≠‡∏≤", label: "‡∏≠‡∏≤" },
        { key: "‡∏à",  label: "‡∏à"  },
        { key: "‡∏≠",  label: "‡∏≠"  },
        { key: "‡∏û",  label: "‡∏û"  },
        { key: "‡∏û‡∏§", label: "‡∏û‡∏§" },
        { key: "‡∏®",  label: "‡∏®"  },
        { key: "‡∏™",  label: "‡∏™"  },
      ],
    };
  },
  computed: {
    // ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
    salaryAmountOptions() {
      const t = this.job.salary_type;
      if (t === "‡∏£‡∏≤‡∏¢‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á") return [50, 60, 80, 100, 120, 150, 200];
      if (t === "‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô")    return [300, 500, 800, 1000, 1500, 2000];
      if (t === "‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô")  return [8000, 10000, 12000, 15000, 18000, 20000, 25000];
      if (t === "‡πÄ‡∏´‡∏°‡∏≤‡∏á‡∏≤‡∏ô")   return [300, 500, 800, 1000, 1500, 2000, 3000, 5000];
      return [];
    },

    // ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤
    jDurationString() {
      if (this.ui.kind === "‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß") {
        return this.ui.dueDate
          ? `‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (‡∏™‡πà‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ${this.thaiDate(this.ui.dueDate)})`
          : "‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß";
      }
      return this.ui.durationPreset || "";
    },

    // ‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏ô + ‡πÄ‡∏ß‡∏•‡∏≤ (‡πÑ‡∏ó‡∏¢ 24 ‡∏ä‡∏°.)
    jWorktimeString() {
      if (this.ui.kind === "‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß") return "‡∏ï‡∏≤‡∏°‡∏ï‡∏Å‡∏•‡∏á/‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô";

      const ds = this.ui.daysSelected.slice();
      if (!ds.length) return "";

      let dayPart = ds.join(", ");
      const isWeekdays = ds.length === 5 && ["‡∏à","‡∏≠","‡∏û","‡∏û‡∏§","‡∏®"].every(k => ds.includes(k));
      const isEveryday = ds.length === 7;

      if (isEveryday) dayPart = "‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô";
      else if (isWeekdays) dayPart = "‡∏à.-‡∏®.";

      const hasBothTime = this.ui.startTime && this.ui.endTime;
      const timePart = hasBothTime ? `${this.timeTH(this.ui.startTime)} ‚Äì ${this.timeTH(this.ui.endTime)}` : "";

      return [dayPart, timePart].filter(Boolean).join(" ‚Ä¢ ");
    },

    // ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á
    jSalaryString() {
      const t = this.job.salary_type;
      if (!t || t === "‡∏ï‡∏≤‡∏°‡∏ï‡∏Å‡∏•‡∏á") return "‡∏ï‡∏≤‡∏°‡∏ï‡∏Å‡∏•‡∏á";
      if (this.job.salary_value != null) {
        return `${t} ${Number(this.job.salary_value).toLocaleString()} ‡∏ö‡∏≤‡∏ó`;
      }
      return t;
    },
  },
  mounted() {
    const u = localStorage.getItem("user");
    if (!u) return this.$router.push("/login");
    this.user = JSON.parse(u);

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß + ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á "‡πÄ‡∏´‡∏°‡∏≤‡∏á‡∏≤‡∏ô"
    this.setKind("‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß", "‡πÄ‡∏´‡∏°‡∏≤‡∏á‡∏≤‡∏ô");
  },
  methods: {
    // ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ 24 ‡∏ä‡∏°. + "‡∏ô."
    timeTH(t) {
      if (!t) return "";
      // t ‡πÄ‡∏õ‡πá‡∏ô "HH:MM" ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏≤‡∏Å input type="time"
      return `${t} ‡∏ô.`;
    },

    setKind(kind, salaryType) {
      this.ui.kind = kind;
      this.job.salary_type = salaryType;
      if (kind === "‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß") {
        this.ui.durationPreset = "‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß";
      } else {
        if (this.ui.durationPreset === "‡∏á‡∏≤‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß") this.ui.durationPreset = "‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á";
      }
    },

    toggleDay(key) {
      const i = this.ui.daysSelected.indexOf(key);
      if (i >= 0) this.ui.daysSelected.splice(i, 1);
      else this.ui.daysSelected.push(key);
    },
    selectWeekdays() { this.ui.daysSelected = ["‡∏à", "‡∏≠", "‡∏û", "‡∏û‡∏§", "‡∏®"]; },
    selectEveryday() { this.ui.daysSelected = ["‡∏≠‡∏≤","‡∏à","‡∏≠","‡∏û","‡∏û‡∏§","‡∏®","‡∏™"]; },
    toggleAllDays() {
      this.ui.daysSelected = this.ui.daysSelected.length === 7 ? [] : ["‡∏≠‡∏≤","‡∏à","‡∏≠","‡∏û","‡∏û‡∏§","‡∏®","‡∏™"];
    },

    thaiDate(iso) {
      const d = new Date(iso);
      return isNaN(d) ? iso : d.toLocaleDateString("th-TH", { day: "2-digit", month: "2-digit", year: "numeric" });
    },

    buildSalaryString(type, value) {
      if (!type || type === "‡∏ï‡∏≤‡∏°‡∏ï‡∏Å‡∏•‡∏á") return "‡∏ï‡∏≤‡∏°‡∏ï‡∏Å‡∏•‡∏á";
      if (value != null) return `${type} ${Number(value).toLocaleString()}`;
      return type;
    },

    async submitJob() {
      if (!this.job.title || !this.job.category) return;

      const payload = {
        j_title: this.job.title,
        j_description: this.job.description,
        j_type: this.job.category,
        j_amount: this.job.vacancy || null,

        j_salary: this.buildSalaryString(this.job.salary_type, this.job.salary_value),
        j_salary_type: this.job.salary_type || null,
        j_salary_value: this.job.salary_type === "‡∏ï‡∏≤‡∏°‡∏ï‡∏Å‡∏•‡∏á" ? null : (this.job.salary_value ?? null),

        // ‚úÖ ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤ ‡∏à‡∏∞‡∏™‡πà‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô
        j_worktime: this.jWorktimeString || null,
        j_deliverable: "",
        j_qualification: this.job.qualification || null,
        j_duration: this.jDurationString || null,
        employer_id: this.user.employer_id,
      };

      try {
        await this.$axios.post("http://localhost:3001/api/jobs", payload);
        alert("‚úÖ ‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
        this.$router.push("/employer/dashboard");
      } catch (err) {
        console.error("‚ùå ‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:", err);
        alert("‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
      }
    },
  },
};
</script>

<style scoped>
.form-group { margin-bottom: 20px; }
.label { font-weight: 700; margin-bottom: 6px; display: block; }
.input, .select, textarea.input { margin: 0; }

.container { padding: 24px 16px; }
.card {
  background:#fff; border:1px solid #eef2f7; border-radius:18px;
  padding: 24px 22px; box-shadow: 0 12px 28px rgba(17,24,39,.06);
}
.title { color:#ff6600; font-weight:800; margin:2px 0 18px; }

.grid { display:grid; }
.grid-2 { grid-template-columns: repeat(2, minmax(0,1fr)); }
.gap-4 { gap:16px; }
.gap-5 { gap:20px; }
.mt-2 { margin-top:8px; }

.label { font-weight:700; color:#0f172a; font-size:.95rem; margin-bottom:6px; }
.label.sub { font-weight:600; color:#475569; }
.req { color:#ef4444; }
.input, .select, textarea.input {
  width:100%; border:1px solid #e5e7eb; border-radius:12px; padding:10px 14px;
  font-size:.95rem; outline:none; transition:.15s;
}
.input:focus, .select:focus, textarea.input:focus {
  border-color:#ffd4b3; box-shadow:0 0 0 4px rgba(255,102,0,.12);
}

.chips { display:flex; flex-wrap:wrap; gap:8px; }
.chip {
  border:1px solid #e6e9f0; background:#fff; padding:8px 12px; border-radius:999px;
  font-weight:700; color:#0f172a; transition:.15s; cursor:pointer;
}
.chip:hover { box-shadow:0 6px 18px rgba(16,24,40,.06); transform: translateY(-1px); }
.chip.active { background:#fff5e6; border-color:#ffb380; color:#ff6600; }

.days { display:flex; flex-wrap:wrap; gap:8px; }
.day {
  border:1px solid #e5e7eb; background:#fff; color:#0f172a; border-radius:10px; padding:8px 10px;
  min-width:42px; text-align:center; font-weight:700; cursor:pointer;
}
.day.active { background:#0ea5e9; color:#fff; border-color:#0ea5e9; }

.summary {
  display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:14px;
  border:1px dashed #dbe2ea; border-radius:14px; padding:14px; background:#f8fafc;
}
.sum-item { background:#fff; border:1px solid #eaeef6; border-radius:12px; padding:12px; }
.sum-title { color:#64748b; font-weight:700; font-size:.85rem; margin-bottom:4px; }
.sum-val { color:#0f172a; font-weight:800; }

.pill-fixed{
  display:inline-block; padding:8px 12px; border-radius:999px;
  background:#eef2ff; color:#1e3a8a; border:1px solid #c7d2fe; font-weight:800;
}
.pill-muted{
  display:inline-block; padding:8px 12px; border-radius:999px;
  background:#f1f5f9; color:#0f172a; border:1px dashed #cbd5e1; font-weight:700;
}
.hint{ color:#64748b; font-size:.85rem; margin-top:6px }

.btn-primary {
  width:100%; border:none; background:#ff6600; color:#fff; font-weight:800;
  padding:12px 18px; border-radius:14px; transition:.15s; cursor:pointer;
}
.btn-primary:hover { background:#e65c00; box-shadow:0 8px 20px rgba(255,102,0,.25); transform:translateY(-1px); }

@media (max-width: 900px) {
  .grid-2 { grid-template-columns: 1fr; }
  .summary { grid-template-columns: 1fr; }
}
</style>
